//ðŸ§©Don't Edit this file.âœ¨Generated in Tue Feb 06 2024 14:45:55 GMT+0700 (Indochina Time)âœ¨
model AccountEvent {
  id        Int   @id @default(autoincrement())
  eventID   Int
  // event    Event    @relation(fields: [eventID], references: [id])
  extraData Json  @default("{}") // Array of object in Json string.
  status    Int   @default(0)
  roleID    Int
  role      Role  @relation(fields: [roleID], references: [id])
  User      User? @relation(fields: [userId], references: [id])
  userId    Int?
}

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("CONNECTION_STRING")
}

model Payment {
  id            Int       @id @default(autoincrement())
  buyer         User      @relation(fields: [buyerID], references: [id])
  buyerID       Int
  gateway       String
  paymentID     String?
  amount        Int
  description   String
  accountNumber String?
  reference     String?
  paidAt        DateTime?
  createdAt     DateTime  @default(now())
  paymentStatus Int       @default(0) // 0 = Unpaid/Cancelled, 1 = Paid, 2 = Waiting for Confirmation, 3 = Cancelled
}

model Profile {
  id          Int       @id @default(autoincrement())
  fullName    String?
  studentID   String?
  school      String?
  phone       String?
  gen         Int?
  dob         DateTime? @db.Date
  departments String[]
  position    String?   @default("member")
  facebook    String?
  user        User?     @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId      Int?      @unique // relation scalar field (used in the `@relation` attribute above)
}

model Role {
  id           Int            @id @default(autoincrement())
  name         String         @unique
  actions      RoleActivity[]
  users        User[]
  AccountEvent AccountEvent[]
}

model RoleActivity {
  id          Int    @id @default(autoincrement())
  name        String @unique
  description String
  roles       Role[]
}

model User {
  id            Int            @id @default(autoincrement())
  username      String         @unique
  email         String         @unique
  password      String
  createdAt     DateTime       @default(now())
  createdBy     String         @default("system")
  role          Role           @relation(fields: [roleID], references: [id])
  roleID        Int            @default(2) // role of user
  accountEvents AccountEvent[] // list of events that user has joined
  profile       Profile?
  Payment       Payment[]
}
